# INDEX 최적화 원리

### INDEX를 최적화한다는 의미는?
Index는 쿼리 최적화를 위해서 쓰이는 가장 기본적인 방법이다. 기본적으로 어떤 데이터를 확인할 때 Index Scan vs Full Scan으로 확인이 가능하다.
Index Scan의 경우에는 적은 데이터를 Searching할 때 많이 사용하는데 Index의 위치, 조건 등으로 인한 속도는 천차만별이다.

### INDEX 위치에 따른 최적화
보통 처음에 Index는 1개(보통은 id)로만 이루어져 있는데 이러한 쿼리를 최적화하기 위해서는 2개 이상의 Index column을 사용하게 된다.
Index Column이 2개 이상일 때 해당 column의 순서에 따라 최적화가 달라진다.
인덱스는 수직적 탐색을 통하여 이루어지기 때문에 **복합키의 경우 카드널리티가 작은 것부터 넣는 것이 좋다.**

### 쿼리 작성 시 조건 최적화
Index를 위와 같이 잘 작성했음에도 불구하고 쿼리문에 따라서 최적화가 되지 않을 수 있는데 이것은 Index Scan이 중간에 끊기는 경우이다.
1. Index Column의 순서에 맞지 않게 조건절을 붙이는 경우 : C1 ~ C4 Index일 때 C1 = 1 and C2 = 2 and C4 = 5 와 같이 중간이 끊기는 경우
  * 해당 부분은 잘 확인해서 ERD 및 index 위치에서 확인해야 한다. 
2. 인덱스 컬럼 중간에 범위연산을 넣는 경우 : C1 ~ C4까지 Index Column일때 중간에 C3 between 1 and 5 와 같이 쓰면 3번째부터는 끊기게 된다.
  **단, C1(제일 첫 Index Column)에서 조건을 붙일 경우는 최적화가 매우 잘된다.(속도가 빨라진다.)** => 맨 앞의 카드널리티가 낮아야하는 이유
